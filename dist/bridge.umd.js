(function(s){typeof define=="function"&&define.amd?define(s):s()})((function(){"use strict";(()=>{function f(){const t=["Joycon2","JoyCon2"];for(const e of t){const o=window[e];if(o){if(typeof o=="function")return o;if(typeof o=="object"){const n=["Joycon2","JoyCon2"];for(const r of n)if(typeof o[r]=="function")return o[r];for(const r of Object.keys(o))try{if(typeof o[r]=="function")return o[r]}catch{}}}}return null}const a=new Set;function d(){function t(...e){if(!(this instanceof t))throw new Error("JoyCon2 must be called with new");this.__ctorArgs=e,this.__real=null,this.__queue=[];const o=(n,r,i,p)=>{const c={type:n,args:r};if(i&&(c.resolve=i,c.reject=p),this.__queue.push(c),n==="connect"&&i)return new Promise((w,g)=>{c.resolve=w,c.reject=g})};this.connect=(...n)=>this.__real&&typeof this.__real.connect=="function"?this.__real.connect(...n):o("connect",n,null,null),this.disconnect=(...n)=>this.__real&&typeof this.__real.disconnect=="function"?this.__real.disconnect(...n):o("disconnect",n),this.onUpdate=n=>this.__real&&typeof this.__real.onUpdate=="function"?this.__real.onUpdate(n):o("onUpdate",[n]),Object.defineProperty(this,"gJoyCon2Data",{get:()=>this.__real?this.__real.gJoyCon2Data:null,configurable:!0}),Object.defineProperty(this,"buttonUp",{get:()=>this.__real?!!(this.__real.gJoyCon2Data&&this.__real.gJoyCon2Data.buttonUp):!1,configurable:!0}),a.add(this)}try{Object.defineProperty(t,"name",{value:"JoyCon2"})}catch{}return t}function _(t){if(typeof t=="function"){try{window.JoyCon2=t}catch{}for(const e of Array.from(a))try{const o=new t(...e.__ctorArgs||[]);for(const n of e.__queue){if(n.type==="onUpdate"){try{o.onUpdate(...n.args||[])}catch{}continue}if(n.type==="disconnect"){try{o.disconnect(...n.args||[])}catch{}continue}if(n.type==="connect"){n.resolve?o.connect(...n.args||[]).then(n.resolve).catch(n.reject):o.connect(...n.args||[]).catch(()=>{});continue}}e.__real=o,e.__queue=[],a.delete(e)}catch(o){console.warn("joycon bridge: failed to bind proxy instance",o)}}}const l=f();if(l)try{window.JoyCon2=l;try{window.Joycon2=l}catch{}console.log("joycon bridge: JoyCon2 constructor installed");return}catch(t){console.warn("joycon bridge: failed to set JoyCon2 directly",t)}const u=d();try{window.JoyCon2=u}catch{}try{window.Joycon2=u}catch{}console.log("joycon bridge: installed proxy constructor for JoyCon2 (will bind when real lib loads)");const h=Date.now(),y=setInterval(()=>{const t=f();if(t){clearInterval(y);try{_(t),console.log("joycon bridge: real JoyCon2 constructor found and bound")}catch(e){console.warn("joycon bridge: error while binding real constructor",e)}return}Date.now()-h>1e4&&(clearInterval(y),console.warn("joycon bridge: timed out waiting for real JoyCon2 constructor"))},200)})()}));
//# sourceMappingURL=bridge.umd.js.map
